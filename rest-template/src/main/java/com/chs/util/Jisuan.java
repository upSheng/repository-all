package com.chs.util;

import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.*;
import java.util.*;

/**
 * @author : HongSheng.Chen
 * @date : 2020/8/4 16:39
 */
public class Jisuan {
    public static void main(String[] args) throws Exception {

        String[] aa = new String[]{"`4200000328201905236403334932",
                "`4200000313201907144418845167",
                "`4200000318201907024511627879",
                "`4200000329201907101979042416",
                "`4200000372201909106659605980",
                "`4200000372201910032207570000",
                "`4200000373201908103342947482",
                "`4200000373201909067479983910",
                "`4200000374201907203709549345",
                "`4200000375201910015068137840",
                "`4200000375201910058215709055",
                "`4200000376201907207828930196",
                "`4200000377201907193033192603",
                "`4200000378201908249828068746",
                "`4200000379201907202392703624",
                "`4200000379201908046788202487",
                "`4200000380201907193521007741",
                "`4200000380201908107888264258",
                "`4200000380201909245639182110",
                "`4200000382201907191384973064",
                "`4200000382201908102025051162",
                "`4200000382201909261438005976",
                "`4200000382201910027341330555",
                "`4200000383201907192084690072",
                "`4200000383201907229063815596",
                "`4200000383201908084588413103",
                "`4200000383201909060698986685",
                "`4200000383201910034844755872",
                "`4200000384201907191979009264",
                "`4200000386201907193207300876",
                "`4200000387201909040184667134",
                "`4200000387201909052125562215",
                "`4200000388201907202292877579",
                "`4200000388201908306744914458",
                "`4200000388201909041803714920",
                "`4200000389201909181654605438",
                "`4200000390201907199598364451",
                "`4200000390201907200628112197",
                "`4200000390201908160198432752",
                "`4200000391201908168858424032",
                "`4200000391201909100742934036",
                "`4200000392201907190580325564",
                "`4200000392201907199179093576",
                "`4200000392201908123423265479",
                "`4200000393201907201178032457",
                "`4200000393201908192045269788",
                "`4200000393201909045077245709",
                "`4200000393201910082150264865",
                "`4200000394201909291595545725",
                "`4200000395201909264989157774",
                "`4200000396201907195828148490",
                "`4200000396201908254611236711",
                "`4200000397201907190099991124",
                "`4200000397201907202877827453",
                "`4200000397201908041592542179",
                "`4200000397201908144193241965",
                "`4200000398201907201056152845",
                "`4200000398201908142510601856",
                "`4200000398201908273573033592",
                "`4200000398201909103579066048",
                "`4200000399201907201915790510",
                "`4200000400201908141033922722",
                "`4200000401201908295365873483",
                "`4200000401201909109549789291",
                "`4200000422201910126744873424",
                "`4200000422201910236902589459",
                "`4200000424201910257941327205",
                "`4200000425201910139859488488",
                "`4200000425201910206119570486",
                "`4200000426201910180646992232",
                "`4200000428201910122464734062",
                "`4200000429201910242497726098",
                "`4200000432201910190356533240",
                "`4200000433201910122154860727",
                "`4200000434201910116083198921",
                "`4200000434201910203064562189",
                "`4200000434201910248470085378",
                "`4200000435201910206466480287",
                "`4200000438201910122955611333",
                "`4200000438201910157554118188",
                "`4200000438201910206202442663",
                "`4200000439201910133412939559",
                "`4200000439201910225171433904",
                "`4200000442201910257637193925",
                "`4200000442201910268577166777",
                "`4200000444201910101932576035",
                "`4200000444201910105417333153",
                "`4200000448201910151001776088",
                "`4200000448201910196533615236",
                "`4200000448201910209915687895",
                "`4200000448201910221076488947",
                "`4200000450201910115943626106",
                "`4200000422201911056030998080",
                "`4200000422201911095709678578",
                "`4200000422201911101806255191",
                "`4200000422201911109479119659",
                "`4200000422201911117312102481",
                "`4200000422201911271775000599",
                "`4200000422201911286395299046",
                "`4200000422201912081288340981",
                "`4200000423201911208994536203",
                "`4200000423201911280326431948",
                "`4200000424201911220682285340",
                "`4200000424201912053063862547",
                "`4200000425201911102496759928",
                "`4200000425201911247117097693",
                "`4200000426201911136044183659",
                "`4200000426201911184995191585",
                "`4200000426201912121789435753",
                "`4200000426201912202320386039",
                "`4200000427201911067723822913",
                "`4200000427201911121555432210",
                "`4200000427201911161286198924",
                "`4200000427201911207476866410",
                "`4200000427201911208034575085",
                "`4200000427201911211735123370",
                "`4200000427201912144917404155",
                "`4200000428201911057760232122",
                "`4200000428201911109550758603",
                "`4200000428201911266507946267",
                "`4200000429201911012764752556",
                "`4200000429201911080090440784",
                "`4200000429201911303536125872",
                "`4200000430201911037613595263",
                "`4200000430201911064632203023",
                "`4200000430201911266169338245",
                "`4200000430201912024883052443",
                "`4200000430201912201557961646",
                "`4200000431201911036269208341",
                "`4200000431201911067001075976",
                "`4200000431201911127260649118",
                "`4200000431201911201059445373",
                "`4200000431201911201735731326",
                "`4200000431201912047704883253",
                "`4200000431201912096560644047",
                "`4200000432201911030441849803",
                "`4200000432201911123224106546",
                "`4200000432201911209325238593",
                "`4200000432201911249359036615",
                "`4200000432201911272853170406",
                "`4200000432201912093898173654",
                "`4200000432201912130894895452",
                "`4200000432201912226012394895",
                "`4200000433201911050114533046",
                "`4200000433201911059106136143",
                "`4200000433201912064566390622",
                "`4200000433201912083971610189",
                "`4200000434201911253329429765",
                "`4200000434201912034004237374",
                "`4200000435201911272345484208",
                "`4200000436201911295926036169",
                "`4200000436201912061505633243",
                "`4200000436201912077381527008",
                "`4200000437201911172584428491",
                "`4200000437201911206070749352",
                "`4200000437201911241825023487",
                "`4200000437201912115298220887",
                "`4200000438201911153660975889",
                "`4200000438201911173287412113",
                "`4200000438201911191543398535",
                "`4200000438201911208110427340",
                "`4200000438201911277073312153",
                "`4200000438201912082571728246",
                "`4200000439201911020846237438",
                "`4200000439201911213396659089",
                "`4200000440201911201133821258",
                "`4200000440201911227839912780",
                "`4200000441201911027547688160",
                "`4200000441201911108979860940",
                "`4200000441201911165163554972",
                "`4200000441201911199158964301",
                "`4200000441201911226597585615",
                "`4200000441201911253704685106",
                "`4200000441201911267731326249",
                "`4200000441201912011185505187",
                "`4200000442201910268577166777",
                "`4200000442201911076416238211",
                "`4200000442201911128503680620",
                "`4200000442201911160099265646",
                "`4200000442201911206358022322",
                "`4200000442201911269889384275",
                "`4200000442201912128546407840",
                "`4200000443201911039124265832",
                "`4200000443201911167058921397",
                "`4200000443201911238389249659",
                "`4200000443201911307284267971",
                "`4200000443201912078520037702",
                "`4200000443201912166665039516",
                "`4200000443201912167769337307",
                "`4200000443201912227547632522",
                "`4200000444201911130865377642",
                "`4200000444201911200548309164",
                "`4200000444201911201782596870",
                "`4200000444201911206861628738",
                "`4200000444201911218591824761",
                "`4200000444201912053637243083",
                "`4200000444201912125850543592",
                "`4200000445201911141800572825",
                "`4200000445201911151677552015",
                "`4200000445201911161359625897",
                "`4200000445201911194148163173",
                "`4200000445201911202257135115",
                "`4200000445201911225565810084",
                "`4200000445201911248814907124",
                "`4200000445201911296274655808",
                "`4200000445201911300953870592",
                "`4200000445201912144872046287",
                "`4200000446201910293121990238",
                "`4200000446201911095466055592",
                "`4200000446201911115324460675",
                "`4200000446201911140119115812",
                "`4200000446201911202212130750",
                "`4200000446201912049413061555",
                "`4200000447201911042764519045",
                "`4200000447201911084907460688",
                "`4200000447201911205364079034",
                "`4200000447201911207142085903",
                "`4200000447201911228699814196",
                "`4200000447201911244435180949",
                "`4200000448201910300008941097",
                "`4200000448201911147028624010",
                "`4200000448201911209099900102",
                "`4200000448201912133544618209",
                "`4200000448201912172368455944",
                "`4200000448201912217890889407",
                "`4200000449201912041990940865",
                "`4200000450201911037193058192",
                "`4200000450201911289742758087",
                "`4200000450201912083600523824",
                "`4200000451201911268575388588",
                "`4200000452201911122044015848",
                "`4200000453201911062445176875",
                "`4200000454201911134717259251",
                "`4200000456201911130304524178",
                "`4200000456201911134084726266",
                "`4200000458201911131039407257",
                "`4200000459201911131632097328",
                "`4200000459201911137102079494",
                "`4200000460201911124541675600",
                "`4200000460201911132023314542",
                "`4200000460201911139540504054",
                "`4200000461201911068210805632",
                "`4200000461201911079361756547",
                "`4200000461201911131901464263",
                "`4200000461201911139668215741",
                "`4200000462201911133855386636",
                "`4200000463201911134217172229",
                "`4200000464201911134303470557",
                "`4200000465201911075517094092",
                "`4200000465201911132608783264",
                "`4200000466201911136952888789",
                "`4200000466201911139294478659",
                "`4200000467201911131542515290",
                "`4200000467201911135449817515",
                "`4200000467201911138083985170",
                "`4200000468201911137978044287",
                "`4200000468201911138102313045",
                "`4200000468201911138758239219",
                "`4200000469201911135924964907",
                "`4200000470201911137485356440"};


        Set<String> set = new HashSet<String>();

        for (String c : aa) {
            set.add(c);
        }


        Map<String, List<String>> mapResult = data();


        String filePath = "d:/804/data.xlsx";
        String outPath = "d:/804/data1.xlsx";
        InputStream is = new FileInputStream(filePath);
        Workbook wb = new XSSFWorkbook(is);
        Sheet sheet = wb.getSheetAt(0);
        int rowNum = sheet.getLastRowNum();
        int temp = 0;
        for (int i = 0; i <= rowNum; i++) {
            Row row = sheet.getRow(i);
            String stringCellValue = row.getCell(0).getStringCellValue();
            if (!mapResult.containsKey(stringCellValue)) {

                row.getCell(0).setCellValue("0");
            }else {

                row.getCell(18).setCellValue(mapResult.get(stringCellValue).get(0));
                row.getCell(19).setCellValue(mapResult.get(stringCellValue).get(2));
                row.getCell(20).setCellValue(mapResult.get(stringCellValue).get(3));
            }
        }
        System.out.println(temp);

        OutputStream os = new FileOutputStream(outPath);
        wb.write(os);

        os.flush();
        os.flush();
        wb.close();


    }


    private static   Map<String, List<String>> data() throws Exception {
        String filePath = "d:/804/data3.xlsx";

        InputStream is = new FileInputStream(filePath);
        Workbook wb = new XSSFWorkbook(is);
        Sheet sheet = wb.getSheetAt(0);
        int rowNum = sheet.getLastRowNum();


        Map<String, List<String>> result = new HashMap<>();
        for (int i = 0; i <= rowNum; i++) {
            Row row = sheet.getRow(i);
            List<String> list = new ArrayList<>();


            String gid = row.getCell(0).getStringCellValue();
            String tr =  row.getCell(1).getStringCellValue();
            String appName = row.getCell(2).getStringCellValue();
            String appKey = row.getCell(3).getStringCellValue();

            list.add(gid);
            list.add(tr);
            list.add(appName);
            list.add(appKey);


            result.put(tr, list);


        }
        return result;
    }
}
